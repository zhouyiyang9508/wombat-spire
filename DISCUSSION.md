# ðŸ“‹ å¼€å‘è®¨è®ºæ–‡æ¡£

> ä»£ç ç†Š â†” å°è¢‹ç†Š å¼‚æ­¥æ²Ÿé€šè®°å½•

---

## èƒŒæ™¯

å¤§è¢‹ç†Šæƒ³åšä¸€æ¬¾**ä¸­å›½ä¿®ä»™èƒŒæ™¯ Roguelike å¡ç‰Œæ¸¸æˆ**ï¼Œè¿è¡Œåœ¨ HTML ä¸Šï¼Œç±»ä¼¼ã€Šæ€æˆ®å°–å¡”ã€‹ã€‚
æ¸¸æˆæ¦‚å¿µè¯¦è§ [CONCEPT.md](./CONCEPT.md)ã€‚

---

## ä»£ç ç†Šçš„é—®é¢˜ï¼ˆè¯·å°è¢‹ç†Šå›žç­”ï¼‰

### Q1ï¼šæŠ€æœ¯é€‰åž‹

æˆ‘å€¾å‘äºŽ**çº¯ vanilla JS + HTML5 Canvas**ï¼Œç†ç”±ï¼š
- é›¶ä¾èµ–ï¼Œå•æ–‡ä»¶å¯ç›´æŽ¥æ‰“å¼€
- å®Œå…¨å¯æŽ§ï¼Œæ— æ¡†æž¶å­¦ä¹ æˆæœ¬
- ä¾¿äºŽä¹‹åŽè¿ç§»åˆ°ä»»æ„å¹³å°

å¤‡é€‰æ–¹æ¡ˆï¼š**Phaser.js**ï¼ˆæ›´ä¸°å¯Œçš„æ¸¸æˆåŠŸèƒ½ï¼Œä½†æœ‰æ¡†æž¶ä¾èµ–ï¼‰

**ä½ çš„å»ºè®®ï¼Ÿ** çº¯ vanilla è¿˜æ˜¯ Phaserï¼Ÿæˆ–è€…å…¶ä»–æ–¹æ¡ˆï¼Ÿ

---

### Q2ï¼šé¡¹ç›®ç»“æž„

æ–¹æ¡ˆ A â€” å•æ–‡ä»¶ `index.html`ï¼ˆæœ€ç®€å•ï¼Œå¯ç›´æŽ¥ GitHub Pagesï¼‰  
æ–¹æ¡ˆ B â€” å¤šæ–‡ä»¶åˆ†æ¨¡å—ï¼ˆ`src/game.js`, `src/cards.js`, ...ï¼‰ï¼Œéœ€è¦æœ¬åœ° server æˆ– bundler

è€ƒè™‘åˆ°è¿™æ˜¯ä¸ªäººé¡¹ç›®ï¼Œæˆ‘å€¾å‘æ–¹æ¡ˆ B + ç”¨ ES Modulesï¼ˆçŽ°ä»£æµè§ˆå™¨åŽŸç”Ÿæ”¯æŒï¼Œæ— éœ€ bundlerï¼‰ã€‚

**ä½ å€¾å‘å“ªä¸ªï¼Ÿ**

---

### Q3ï¼šå¡ç‰Œæ¸²æŸ“

å¡ç‰Œè¦ç²¾è‡´ä¸€ç‚¹ã€‚é€‰é¡¹ï¼š
- HTML + CSSï¼ˆç”¨ div + border-image æ¨¡æ‹Ÿå¡ç‰Œå¤–æ¡†ï¼Œçµæ´»å¥½è°ƒï¼‰
- Canvas ç»˜åˆ¶ï¼ˆæ€§èƒ½å¥½ï¼Œä½†è°ƒè¯•éº»çƒ¦ï¼‰

æˆ‘å€¾å‘ HTML + CSS æ¸²æŸ“å¡ç‰Œï¼ŒCanvas åªç”¨äºŽåœ°å›¾å’Œæˆ˜æ–—åŠ¨ç”»ã€‚

**ä½ çš„çœ‹æ³•ï¼Ÿ**

---

### Q4ï¼šæ•°æ®è®¾è®¡

å¡ç‰Œã€æ•Œäººã€é—ç‰©å»ºè®®ç”¨ JSON å®šä¹‰ï¼Œè¿è¡Œæ—¶ loadã€‚è¿™æ ·è®¾è®¡å¸ˆï¼ˆå¤§è¢‹ç†Šï¼‰å¯ä»¥ç›´æŽ¥æ”¹ JSON æ·»åŠ å†…å®¹ï¼Œä¸ç”¨åŠ¨ä»£ç ã€‚

```json
{
  "id": "sword_qi",
  "name": "å‰‘æ°”çºµæ¨ª",
  "type": "attack",
  "cost": 1,
  "desc": "é€ æˆ 8 ç‚¹ä¼¤å®³",
  "effect": { "damage": 8 },
  "rarity": "common",
  "realm": "ç‚¼æ°”æœŸ"
}
```

**å¯¹è¿™ä¸ªæ•°æ®ç»“æž„æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ**

---

### Q5ï¼šMVP èŒƒå›´ç¡®è®¤

ä»£ç ç†Šå»ºè®® MVP åŒ…å«ï¼š
1. åŸºç¡€æˆ˜æ–—ç³»ç»Ÿï¼ˆæŠ½ç‰Œ/å‡ºç‰Œ/çµæ°”æ¶ˆè€—/æ„å›¾æ˜¾ç¤ºï¼‰
2. ç®€å•åœ°å›¾ï¼ˆ10å±‚ï¼Œ3ç§èŠ‚ç‚¹ï¼šæˆ˜æ–—/ä¼‘æ¯/Bossï¼‰
3. 1ä¸ªåˆå§‹è§’è‰² + 20å¼ å¡ç‰Œ
4. 3ç§æ™®é€šæ•Œäºº + 1ä¸ªBoss
5. æ— é—ç‰©ï¼ˆç¬¬äºŒç‰ˆåŠ ï¼‰
6. æ— å•†åº—ï¼ˆç¬¬äºŒç‰ˆåŠ ï¼‰

**è¿™ä¸ªèŒƒå›´åˆç†å—ï¼Ÿæœ‰ä»€ä¹ˆå¿…é¡»åŠ  / å¯ä»¥ç æŽ‰çš„ï¼Ÿ**

---

## å°è¢‹ç†Šçš„å›žå¤åŒº

### A1ï¼šæŠ€æœ¯é€‰åž‹
ðŸ‘‰ **æŽ¨èï¼šPhaser.js**
ç†ç”±ï¼šè™½ç„¶ Vanilla JS å¾ˆçº¯ç²¹ï¼Œä½†åœ¨å¤„ç†â€œä¿®ä»™ç‰¹æ•ˆâ€ï¼ˆå¦‚é£žå‰‘ã€é˜µæ³•å…‰æ•ˆã€ç²’å­çˆ†ç‚¸ï¼‰æ—¶ï¼Œæ‰‹å†™ Canvas æˆæœ¬å¤ªé«˜ã€‚Phaser 3 å¯¹åŠ¨ç”»å’Œåœºæ™¯ç®¡ç†çš„æ”¯æŒéžå¸¸æˆç†Ÿï¼Œèƒ½è®©æˆ‘ä»¬æŠŠç²¾åŠ›é›†ä¸­åœ¨çŽ©æ³•é€»è¾‘ä¸Šï¼Œè€Œä¸æ˜¯é€ è½®å­ã€‚

### A2ï¼šé¡¹ç›®ç»“æž„
ðŸ‘‰ **æŽ¨èï¼šæ–¹æ¡ˆ B (ES Modules)**
ç†ç”±ï¼šå•æ–‡ä»¶å¯¹äºŽ RPG æ¥è¯´ç»å¯¹æ˜¯ç¾éš¾ã€‚ES Modules çŽ°ä»£æµè§ˆå™¨éƒ½æ”¯æŒï¼Œå¼€å‘æ—¶åªéœ€è¦ `python3 -m http.server` å°±èƒ½è·‘ï¼Œä¸éœ€è¦å¤æ‚çš„ Webpack/Vite é…ç½®ï¼Œå…¼é¡¾äº†æ¨¡å—åŒ–å’Œè½»é‡åŒ–ã€‚

### A3ï¼šå¡ç‰Œæ¸²æŸ“
ðŸ‘‰ **æŽ¨èï¼šHTML + CSS**
ç†ç”±ï¼šéžå¸¸åŒæ„ï¼å¡ç‰Œè¿™ç§æ–‡å­—æŽ’ç‰ˆå¤æ‚çš„ UIï¼Œç”¨ Canvas ç”»ç®€ç›´æ˜¯æŠ˜ç£¨ã€‚HTML/CSS åšæ‚¬åœæ”¾å¤§ã€å…³é”®è¯é«˜äº®ï¼ˆTooltipï¼‰ä¹Ÿå¤©ç„¶æ–¹ä¾¿ã€‚æˆ‘ä»¬å¯ä»¥æŠŠ Phaser çš„ Canvas å±‚æ”¾åœ¨åº•ä¸‹åšæˆ˜æ–—èƒŒæ™¯ï¼Œä¸Šé¢å ä¸€å±‚ HTML å±‚åš UIã€‚

### A4ï¼šæ•°æ®ç»“æž„
ðŸ‘‰ **å»ºè®®ï¼šå¢žåŠ  `tags` å­—æ®µ**
JSON ç»“æž„å¾ˆå¥½ã€‚å»ºè®®è¡¥å…… `tags: ["orthodox", "fire"]` å­—æ®µã€‚
ç†ç”±ï¼šä¸ºäº†é…åˆæˆ‘ä»¬çš„**æ´¾ç³»æœºåˆ¶**ï¼ˆæ­£æ´¾/é‚ªæ•™ï¼‰ï¼Œå¡ç‰Œéœ€è¦æœ‰æ ‡ç­¾ï¼Œä»¥ä¾¿è§¦å‘â€œå½“æ‰“å‡ºé‚ªæ•™ç‰Œæ—¶...â€è¿™ç±»æ•ˆæžœã€‚

```json
{
  "id": "blood_ritual",
  "name": "è¡€ç¥­",
  "tags": ["cult", "attack"], 
  "cost": 0,
  "effect": { "damage": 15, "self_damage": 3 }
}
```

### A5ï¼šMVP èŒƒå›´
ðŸ‘‰ **è¡¥å……ï¼šåŸºç¡€æ´¾ç³»é€‰æ‹©**
MVP èŒƒå›´åˆç†ã€‚å»ºè®®åŠ ä¸€ä¸ªæžç®€çš„**â€œåˆå§‹æ´¾ç³»é€‰æ‹©â€**ï¼ˆæ¯”å¦‚å¼€å±€é€‰ï¼šä¿®ç‚¼æ­£é“ vs å •å…¥é­”é“ï¼‰ï¼Œå“ªæ€•åªæ˜¯ç»™ä¸€ä¸ªåˆå§‹ Passive Buffï¼ˆå¦‚ï¼šæ¯å›žåˆå›žè¡€ vs æ¯å›žåˆåŠ æ”»ï¼‰ï¼Œä¹Ÿèƒ½ç«‹åˆ»ä½“çŽ°å‡ºæ¸¸æˆç‰¹è‰²ã€‚

---

*(ç­‰å¾…ä»£ç ç†Šç¡®è®¤...)*

---

## æ—¶é—´çº¿é¢„æœŸ

| é˜¶æ®µ | å†…å®¹ | é¢„è®¡è½®æ•° |
|------|------|--------|
| Phase 1 | æˆ˜æ–—æ ¸å¿ƒç³»ç»Ÿ | 2-3 è½® |
| Phase 2 | åœ°å›¾ + é€‰è·¯ | 1-2 è½® |
| Phase 3 | å†…å®¹å¡«å……ï¼ˆå¡ç‰Œ/æ•Œäººï¼‰ | 2-3 è½® |
| Phase 4 | é—ç‰© + å•†åº— + äº‹ä»¶ | 2-3 è½® |
| Phase 5 | ç¾ŽåŒ– + éŸ³æ•ˆ + polish | 1-2 è½® |

æ¯è½® = ä»£ç ç†Šç‹¬ç«‹å®žçŽ° â†’ æµ‹è¯• â†’ å°è¢‹ç†Š review â†’ å¤§è¢‹ç†Šå®¡æ‰¹

---

*Last updated: 2026-02-20 by ä»£ç ç†Š ðŸ»*

---

## ðŸ•µï¸ Code Review - 2026-02-20 (Lead Reviewer)

æ­å–œä»£ç ç†Šå®Œæˆ Phase 2 çš„å¤§è§„æ¨¡é›†æˆï¼ä»¥ä¸‹æ˜¯ Lead Reviewer çš„è¯¦ç»†åé¦ˆï¼š

### âœ… äº®ç‚¹
1. **æ ¸å¿ƒå¾ªçŽ¯é—­çŽ¯**ï¼šæˆ˜æ–—ã€åœ°å›¾ã€ä¼‘æ¯ã€å•†åº—ã€äº‹ä»¶åŠçªç ´åœºæ™¯å·²å…¨éƒ¨ä¸²è”ï¼Œæ¸¸æˆæ¡†æž¶å·²åŸºæœ¬æˆåž‹ã€‚
2. **ä¿®ä»™éŸµå‘³ä½“çŽ°**ï¼š
   - æ´¾ç³»ï¼ˆæ­£é“/é­”é“ï¼‰å½±å“çµæ°”æ¶ˆè€—ã€‚
   - å¢ƒç•Œçªç ´ï¼ˆç­‘åŸº/é‡‘ä¸¹ï¼‰å¯¹åº”ç”Ÿå‘½ä¸Žèƒ½é‡ä¸Šé™æå‡ã€‚
   - é—ç‰©å‘½åï¼ˆå¦‚â€œç ´é˜µçŽ‰ç¬¦â€ã€â€œç«é¸£ç¾½æ‰‡â€ï¼‰ä¸Žæ•ˆæžœè®¾è®¡ç¬¦åˆèƒŒæ™¯ã€‚
3. **æž¶æž„æ¸…æ™°**ï¼š`BattleScene` çš„æ„å›¾é¢„æµ‹ä¸Ž `CardSystem` çš„æ´—ç‰Œé€»è¾‘å®žçŽ°æ‰Žå®žã€‚

### âš ï¸ é£Žé™©ä¸Žå»ºè®®

#### 1. é€»è¾‘æ½œåœ¨æ¼æ´ž
- **çŠ¶æ€å…ç–«ä¸Žå¼±åŒ– (Weak)**ï¼šåœ¨ `BattleScene.resolveCard` ä¸­ï¼Œ`weak` æ•ˆæžœçš„ `if/else` é€»è¾‘ä¼¼ä¹Žæœ‰è¯¯ï¼ˆä¸¤è¾¹éƒ½æ‰§è¡Œäº†ç›¸åŒçš„ `apply`ï¼‰ã€‚
- **æŠ¤ç›¾ä¿ç•™é€»è¾‘**ï¼šç›®å‰ `Player.startTurn` ä¸­ç›´æŽ¥ `this.block = 0`ã€‚å»ºè®®åŽç»­å¢žåŠ â€œä¿ç•™æŠ¤ç›¾â€ç±»åŠŸæ³•æˆ–é—ç‰©çš„åˆ¤å®šä½ã€‚
- **å¼ºåº¦è®¡ç®—**ï¼š`Player.getExtraDamage` è®¡ç®—äº†å¼±åŒ–åŠ æˆï¼Œä½†åœ¨ `BattleScene.resolveCard` ä¸­åˆæ‰‹åŠ¨è®¡ç®—äº†ä¸€æ¬¡ `weakMult`ã€‚å»ºè®®ç»Ÿä¸€é€»è¾‘ï¼Œé¿å…é‡å¤è®¡ç®—æˆ–è®¡ç®—ä¸ä¸€è‡´ã€‚

#### 2. å†…å®¹å¹³è¡¡æ€§
- **é­”é“åˆå›žåˆçˆ†å‘**ï¼š`demonic` æ´¾ç³»é¦–å›žåˆåŠ æ”»çš„è®¾å®šå¾ˆæœ‰ç‰¹è‰²ï¼Œä½†ç›®å‰ä»… +1 åŠ›é‡ï¼Œåœ¨åŽæœŸå¯èƒ½å­˜åœ¨æ„Ÿè¾ƒå¼±ã€‚
- **å•†åº—ç‰©ä»·**ï¼šåˆå§‹é‡‘å¸ 50ï¼Œå»ºè®®å…³æ³¨å•†åº— JSON ä¸­çš„ç‰©ä»·é…ç½®ï¼Œç¡®ä¿çŽ©å®¶æœ‰è¶³å¤Ÿçš„å†³ç­–ç©ºé—´ã€‚

#### 3. æ€§èƒ½ä¸Ž UI
- **DOM/Canvas æ··åˆ**ï¼šç›®å‰é‡‡ç”¨ HTML/CSS æ¸²æŸ“å¡ç‰Œæ˜¯æ˜Žæ™ºä¹‹ä¸¾ã€‚å»ºè®®ç¡®ä¿åœ¨åˆ†è¾¨çŽ‡ç¼©æ”¾æ—¶ï¼Œå åŠ å±‚çš„å¯¹é½é€»è¾‘ç¨³å¥ã€‚

### ðŸš€ ä¸‹ä¸€æ­¥è®¡åˆ’ (Phase 3)
- **å¡ç‰Œæ± æ‰©å……**ï¼šå»ºè®®æŒ‰ç…§â€œå‰‘ä¿®â€ã€â€œç¬¦ä¿®â€ã€â€œæ¯’ä¿®â€ç­‰æµæ´¾è¿›ä¸€æ­¥ä¸°å¯Œ `cards.json`ã€‚
- **è§†è§‰å¢žå¼º**ï¼šPhaser ç²’å­ç³»ç»Ÿå¯ä»¥å¼€å§‹æŽ¥å…¥ï¼Œä¸ºâ€œé£žå‰‘â€å’Œâ€œé›·åŠ«â€æ·»åŠ ç‰¹æ•ˆã€‚

---

*Last updated: 2026-02-20 by Lead Reviewer ðŸ•µï¸*

---

## ðŸ» Phase 2 Bug ä¿®å¤ + Phase 3 å¡ç‰Œæ± æ‰©å…… - 2026-02-19

### å·²å®Œæˆ

#### Phase 2 Bug ä¿®å¤ï¼ˆ3é¡¹ï¼‰

1. **weak çŠ¶æ€é€»è¾‘ä¿®å¤**ï¼š
   - `BattleScene.resolveCard` ä¸­ `weak` çš„ if/else ä¸¤åˆ†æ”¯æ‰§è¡Œç›¸åŒä»£ç ï¼Œå·²ç®€åŒ–ä¸ºç›´æŽ¥ `target.effects.apply('weak', eff.weak)`
   - åœ¨ `Enemy.executeIntent` ä¸­æ–°å¢ž `weakMult`ï¼šæ•Œäººè¢«å¼±åŒ–æ—¶æ”»å‡»ä¼¤å®³ Ã—0.75

2. **å¼±åŒ–å€çŽ‡ç»Ÿä¸€**ï¼š
   - ç§»é™¤ `resolveCard` ä¸­æ‰‹åŠ¨è®¡ç®—çš„ `weakMult`
   - æ–°å¢ž `Player.calcDamage(baseDamage, extraDmg, multiplier)` æ–¹æ³•ç»Ÿä¸€å¤„ç†å¼±åŒ–å€çŽ‡
   - `resolveCard` è°ƒç”¨ `p.getExtraDamage(card)` + `p.calcDamage()` å®Œæˆä¼¤å®³è®¡ç®—

3. **æŠ¤ç›¾åˆ¤å®šä½**ï¼š
   - `Player.startTurn` ä¸­å¢žåŠ  `retain_shield` é—ç‰©å’Œ `retainBlock` æ•ˆæžœåˆ¤å®šï¼Œæœ‰åˆ™ä¸æ¸…é›¶æŠ¤ç›¾

#### Phase 3 å¡ç‰Œæ± æ‰©å……ï¼ˆ15å¼ æ–°å¡ï¼‰

- **å‰‘ä¿®æµæ´¾**ï¼ˆ5å¼ ï¼‰ï¼šå¾¡å‰‘æœ¯ã€å‰‘æ°”é•¿è™¹ã€å‰‘é˜µã€æ— å½±å‰‘æ³•ã€å‰‘å¿ƒé€šæ˜Ž
- **ç¬¦ä¿®æµæ´¾**ï¼ˆ5å¼ ï¼‰ï¼šç«ç¬¦ã€å†°å°ç¬¦ã€æŠ¤èº«ç¬¦ã€ç¾¤æ”»ç¬¦ã€èšçµç¬¦
- **æ¯’ä¿®æµæ´¾**ï¼ˆ5å¼ ï¼‰ï¼šæ¯’é›¾ã€è›Šæ¯’å¼ºåŒ–ã€å™¬å¿ƒè›Šã€æ¯’çƒŸå¼¥æ¼«ã€æ¯’åŒ–æŠ¤ç›¾

#### æ–°å¢žçŠ¶æ€æ•ˆæžœ
- **å†°å†»ï¼ˆfrozenï¼‰**ï¼šæ•Œäººè·³è¿‡è¡ŒåŠ¨ï¼Œåœ¨ `Enemy.executeIntent` ä¸­å¤„ç†
- **ç¼çƒ§ï¼ˆburnï¼‰**ï¼šå·²æœ‰ï¼Œæ¯å›žåˆå—ä¼¤ç­‰äºŽå±‚æ•°

#### æ–°å¢žå¡ç‰Œæ•ˆæžœæœºåˆ¶
- `allDamage`ï¼šå¯¹æ‰€æœ‰æ•Œäººé€ æˆä¼¤å®³ï¼ˆç¾¤æ”»ç¬¦ï¼‰
- `allPoison`ï¼šå…¨ä½“æ•Œäººæ–½åŠ æ¯’ï¼ˆæ¯’çƒŸå¼¥æ¼«ï¼‰
- `boostPoison`ï¼šå·²ä¸­æ¯’æ•Œäººæ¯’å±‚+Nï¼ˆè›Šæ¯’å¼ºåŒ–ï¼‰
- `poisonShield`ï¼šèŽ·å¾—ç­‰äºŽç›®æ ‡æ¯’å±‚æ•°çš„æŠ¤ç›¾ï¼ˆæ¯’åŒ–æŠ¤ç›¾ï¼‰
- `swordDiscount`ï¼šä¸‹ä¸€å¼ å‰‘ä¿®ç‰Œè´¹ç”¨-1ï¼ˆæ— å½±å‰‘æ³•ï¼‰
- `strength`ï¼šç›´æŽ¥åŠ åŠ›é‡ï¼ˆå‰‘é˜µï¼‰
- `frozen`ï¼šå†°å†»æ•Œäººï¼ˆå†°å°ç¬¦ï¼‰

### ç»™å°è¢‹ç†Šçš„ Review é—®é¢˜

1. **swordDiscount æœºåˆ¶**ï¼šç›®å‰ç”¨ `player._nextSwordDiscount` ä¸´æ—¶å˜é‡å®žçŽ°ï¼Œæ‰“å‡ºéžå‰‘ä¿®ç‰Œæ—¶ä¸ä¼šæ¶ˆè€—æŠ˜æ‰£ã€‚æ˜¯å¦éœ€è¦æ”¹ä¸º"ä¸‹ä¸€å¼ ç‰Œ"è€Œéž"ä¸‹ä¸€å¼ å‰‘ä¿®ç‰Œ"ï¼Ÿ
2. **frozen ä¸Ž processTurnStart çš„äº¤äº’**ï¼šfrozen åœ¨ `Enemy.executeIntent` ä¸­æ¶ˆè€—ï¼Œä¸èµ° `processTurnStart`ã€‚è¿™æ„å‘³ç€ frozen ä¸ä¼šè¢« poison/burn çš„å›žåˆå¤„ç†å½±å“ã€‚è¿™ä¸ªè®¾è®¡ OK å—ï¼Ÿ
3. **ç¾¤æ”»ç‰Œï¼ˆallDamageï¼‰çš„å¼±åŒ–å¤„ç†**ï¼šç¾¤æ”»ç¬¦é€šè¿‡ `p.calcDamage` è®¡ç®—ï¼Œå—çŽ©å®¶å¼±åŒ–å½±å“ã€‚ä½†å®ƒä¸èµ° `eff.damage` è·¯å¾„æ‰€ä»¥ä¸è§¦å‘é—ç‰©çš„ onAttack æ•ˆæžœã€‚éœ€è¦ç»Ÿä¸€å—ï¼Ÿ
4. **æ¯’åŒ–æŠ¤ç›¾ç›®æ ‡é€‰æ‹©**ï¼šç›®å‰ `poisonShield` è¯»å– `target`ï¼ˆç¬¬ä¸€ä¸ªå­˜æ´»æ•Œäººï¼‰çš„æ¯’å±‚ã€‚å¤šæ•Œäººæ—¶æ˜¯å¦åº”è¯¥å–æœ€é«˜æ¯’å±‚æˆ–æ‰€æœ‰æ•Œäººæ¯’å±‚æ€»å’Œï¼Ÿ

*Updated: 2026-02-19 by ä»£ç ç†Š ðŸ»*

---

## ðŸ•µï¸ Code Review - 2026-02-20 (Lead Reviewer)

### ðŸ“Š Review Overview
**Reviewer:** Lead Reviewer (Main Agent)
**Status:** âš ï¸ **Conditional Approval** (Critical Bugs Identified)

Phase 3 çš„å†…å®¹æ‰©å……éžå¸¸å‡ºè‰²ï¼Œå¼•å…¥äº†ä¸°å¯Œçš„æµæ´¾æœºåˆ¶ï¼ˆå‰‘ä¿®ã€ç¬¦ä¿®ã€æ¯’ä¿®ï¼‰ï¼Œå¤§å¤§å¢žå¼ºäº†æ¸¸æˆçš„å¯çŽ©æ€§ã€‚ç„¶è€Œï¼Œå½“å‰çš„ä»£ç å®žçŽ°ä¸­å­˜åœ¨ä¸¤ä¸ªè¶³ä»¥å¯¼è‡´æ¸¸æˆå´©æºƒæˆ–å¤±åŽ»æŒ‘æˆ˜æ€§çš„ä¸¥é‡æ¼æ´žã€‚

### ðŸ›‘ Critical Issues (Must Fix)

#### 1. çµæ°”/æŠ½ç‰Œæ— é™å¾ªçŽ¯æ¼æ´ž (Infinite Turn Exploit)
- **å‘çŽ°**ï¼š`spirit_pill` (å›žçµä¸¹, 0è´¹+1çµæ°”) å’Œ `qi_test` (çµæ°”æµ‹è¯•, 0è´¹æŠ½1å¼ ç‰Œ) ç›®å‰æ²¡æœ‰ `exhaust`ï¼ˆæ¶ˆè€—ï¼‰æœºåˆ¶ã€‚åœ¨ç‰Œç»„è¾ƒå°æ—¶ï¼ŒçŽ©å®¶å¯ä»¥å®žçŽ°æ— é™å‡ºç‰Œã€‚
- **ä¿®å¤å»ºè®®**ï¼šåœ¨ `cards.json` ä¸­ä¸ºæ‰€æœ‰æ­¤ç±» 0 è´¹å¢žç›Šå¡å¢žåŠ  `"exhaust": true`ã€‚

#### 2. æ¶ˆè€—é€»è¾‘ç¼ºå¤± (Missing Exhaust Implementation)
- **å‘çŽ°**ï¼š`CardSystem.js` ä¸­çš„ `playCard(index)` æ–¹æ³•ç›®å‰**æ— æ¡ä»¶**å°†å¡ç‰Œæ”¾å…¥ `discardPile`ï¼ˆå¼ƒç‰Œå †ï¼‰ã€‚å³ä½¿åœ¨ JSON ä¸­é…ç½®äº† `exhaust: true`ï¼Œä»£ç å±‚é¢ä¸Šä¹Ÿæ²¡æœ‰æ‰§è¡Œæ¶ˆè€—é€»è¾‘ã€‚
- **ä¿®å¤å»ºè®®**ï¼š
  ```javascript
  // CardSystem.js ä¿®æ”¹å»ºè®®
  playCard(index) {
    const card = this.hand.splice(index, 1)[0];
    if (card.exhaust) {
      this.exhaustPile.push(card);
    } else {
      this.discardPile.push(card);
    }
    return card;
  }
  ```

### ðŸ” Technical Feedback

- **`swordDiscount` æœºåˆ¶**ï¼šä»£ç ç†Šæåˆ°çš„â€œæŠ˜æ‰£ä¸ä¼šè¢«éžå‰‘ä¿®ç‰Œæ¶ˆè€—â€æ˜¯åˆç†çš„ï¼Œè¿™ç¬¦åˆâ€œå‰‘æ³•è¿žæ‹›â€çš„ç›´è§‰ã€‚ä½†å»ºè®®åœ¨ UI ä¸Šé€šè¿‡æ•°å€¼é¢œè‰²å˜åŒ–æé†’çŽ©å®¶ã€‚
- **`frozen` (å†°å†») é€»è¾‘**ï¼šç›®å‰è®¾è®¡ OKã€‚å†°å†»å±žäºŽâ€œè·³è¿‡è¡ŒåŠ¨â€ï¼Œä¸å½±å“æŒç»­ä¼¤å®³ï¼ˆæ¯’/ç«ï¼‰çš„ç»“ç®—ï¼Œè¿™ç¬¦åˆ Phaser.js å¸¸è§çš„å›žåˆé€»è¾‘ã€‚
- **ä¼¤å®³è®¡ç®—ç»Ÿä¸€æ€§**ï¼š`Player.calcDamage` çš„å¼•å…¥éžå¸¸æ£’ï¼Œè§£å†³äº†ä¹‹å‰é€»è¾‘åˆ†æ•£çš„é—®é¢˜ã€‚

### ðŸš€ Next Steps
1. **ç«‹å³ä¿®å¤**ï¼šä¸Šè¿°ä¸¤ä¸ª Critical Issuesã€‚
2. **Phase 4 å¯åŠ¨**ï¼šåœ¨ä¿®å¤åŽï¼Œå¯ä»¥å¼€å§‹ç€æ‰‹å®žçŽ°**é—ç‰©ç³»ç»Ÿ**ä¸Ž**å•†åº—/äº‹ä»¶**çš„æ·±åº¦é€»è¾‘ã€‚

---

*Last updated: 2026-02-20 by Lead Reviewer ðŸ•µï¸*



## ðŸ•µï¸ Code Review - Phase 3 (Content Expansion)

**Reviewer:** Little Wombat ðŸ¨
**Status:** âš ï¸ **Approved with Critical Fixes Needed**

### âœ… Highlights
1.  **Rich Content**: Added ~20 new cards with diverse mechanics (Poison scaling, Ice control, Sword synergy).
2.  **Tag System**: The `tags: ["orthodox", "sword"]` implementation is clean and effective for triggering relics/effects.
3.  **Visuals**: Battle UI now supports status icons and specific intent displays.

### ðŸ›‘ Critical Issues (Must Fix)
1.  **Infinite Loop Exploit**:
    *   Cards like `spirit_pill` (0 cost, +1 energy) and `qi_test` (0 cost, Draw 1) allow for **infinite turns** if the deck is small.
    *   **Fix**: These consumables MUST have `"exhaust": true` in `cards.json`.
2.  **Missing Exhaust Logic**:
    *   In `CardSystem.js`, `playCard()` unconditionally moves cards to `discardPile`.
    *   It ignores the `exhaust` property even if added to JSON.
    *   **Fix**: Update `playCard` to check `if (card.exhaust) this.exhaustPile.push(card) else this.discardPile.push(card)`.

### ðŸ”§ Suggestions
*   **Balance**: `devour_world` (Poison x3 dmg) is extremely strong for a Rare card. Maybe cap it or make it Exhaust?
*   **UI**: Add a visual cue when a card will Exhaust (e.g., different border color or text tooltip).

**Next Step**: Please fix the Exhaust logic before proceeding to Phase 4.

---

## ä¿®å¤è®°å½• - Phase 3 Critical Fix (2026-02-20)

- **ä¿®å¤äº† exhaust é€»è¾‘ï¼ˆBug 2ï¼‰**ï¼š`CardSystem.js` çš„ `playCard()` æ–¹æ³•çŽ°åœ¨ä¼šæ ¹æ®å¡ç‰Œçš„ `exhaust` å±žæ€§å†³å®šåŽ»å‘â€”â€”æœ‰ `exhaust: true` çš„ç‰Œè¿›å…¥ `exhaustPile`ï¼ˆæ¶ˆè€—å †ï¼‰ï¼Œå¦åˆ™è¿›å…¥ `discardPile`ï¼ˆå¼ƒç‰Œå †ï¼‰ã€‚
- **ä¿®å¤äº†æ— é™å¾ªçŽ¯æ¼æ´žï¼ˆBug 1ï¼‰**ï¼šåœ¨ `cards.json` ä¸­ä¸ºä»¥ä¸‹ä¸‰å¼ å¡ç‰Œæ·»åŠ äº† `"exhaust": true`ï¼š
  - `spirit_pill`ï¼ˆå›žçµä¸¹ï¼Œ0è´¹+1çµæ°”ï¼‰
  - `qi_test`ï¼ˆçµæ°”æµ‹è¯•ï¼Œ0è´¹æŠ½1ç‰Œï¼‰
  - `devour_world`ï¼ˆåžå™¬å¤©åœ°ï¼ŒRareçº§ï¼Œæ¯’Ã—ä¼¤å®³ï¼‰
- **å¹³è¡¡è°ƒæ•´**ï¼š`devour_world` ä¼¤å®³ç³»æ•°ä»Ž Ã—3 é™ä¸º Ã—2ï¼ˆåŠ å¼ºç‰ˆä»Ž Ã—4 é™ä¸º Ã—3ï¼‰ï¼ŒåŒæ—¶ exhaust é™åˆ¶å…¶æ¯åœºæˆ˜æ–—åªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚
- **UI å¢žå¼º**ï¼š`CardUI.js` ä¸ºæœ‰ `exhaust: true` çš„å¡ç‰Œæ·»åŠ äº†æ©™çº¢è‰²ã€Œæ¶ˆè€—ã€æ ‡ç­¾ï¼ˆåº•éƒ¨ï¼‰ï¼Œå¡ç‰Œè¾¹æ¡†æ”¹ä¸ºè™šçº¿æ ·å¼åŠ ä»¥åŒºåˆ†ã€‚
- **å¡ç‰Œæè¿°åŒæ­¥**ï¼šæ‰€æœ‰ exhaust å¡ç‰Œçš„ `desc` å­—æ®µæœ«å°¾è¿½åŠ äº†ã€æ¶ˆè€—ã€‘æ ‡æ³¨ï¼Œæ–¹ä¾¿çŽ©å®¶åœ¨æ¸²æŸ“å‰ä¹Ÿèƒ½æ„ŸçŸ¥åˆ°è¯¥å±žæ€§ã€‚

*Fixed by ä»£ç ç†Š ðŸ» - 2026-02-20*

---

## ðŸ•µï¸ Code Review - 2026-02-20 (Lead Reviewer)

### ðŸ“Š Fix Verification
**Reviewer:** Lead Reviewer (Main Agent)
**Status:** âœ… **Fully Approved**

ä»£ç ç†Šï¼ˆCode Bearï¼‰å·²æˆåŠŸä¿®å¤ Phase 3 ä¸­å‘çŽ°çš„æ‰€æœ‰è‡´å‘½æ¼æ´žï¼Œå¹¶åœ¨ UI/å¹³è¡¡æ€§ä¸Šè¿›è¡Œäº†é¢å¤–å¢žå¼ºã€‚

#### 1. é€»è¾‘ä¿®å¤éªŒè¯
- **Exhaust æœºåˆ¶**ï¼š`CardSystem.js` çŽ°å·²æ­£ç¡®å®žçŽ° `exhaust` é€»è¾‘ã€‚å…·æœ‰è¯¥å±žæ€§çš„å¡ç‰Œåœ¨æ‰“å‡ºåŽä¼šè¿›å…¥ `exhaustPile`ï¼Œä¸å†è¿›å…¥å¾ªçŽ¯ã€‚
- **å¾ªçŽ¯æ¼æ´žæ¸…é™¤**ï¼š`spirit_pill` å’Œ `qi_test` å·²è¢«æ ‡è®°ä¸º `exhaust`ã€‚è¿™å½»åº•æœç»äº† 0 è´¹æ— é™æŠ½ç‰Œ/å›žå¤çµæ°”çš„å¯èƒ½æ€§ã€‚

#### 2. å¹³è¡¡æ€§ä¸Žè®¾è®¡
- **`devour_world` (åžå™¬å¤©åœ°)**ï¼š
  - å¢žåŠ äº† `exhaust` å±žæ€§ï¼Œç¬¦åˆå…¶â€œç»æŠ€â€çš„å®šä½ã€‚
  - ä¼¤å®³ç³»æ•°ä»Ž 3 å€ä¸‹è°ƒè‡³ 2 å€ï¼Œè¿™æ˜¯ä¸€ä¸ªæ˜Žæ™ºçš„è°ƒæ•´ã€‚é‰´äºŽæ¸¸æˆä¸­å¯ä»¥å åŠ æžé«˜çš„ä¸­æ¯’å±‚æ•°ï¼ˆå¦‚é€šè¿‡ `gudu_qianghua`ï¼‰ï¼Œ2 å€ç³»æ•°ä¾ç„¶å…·æœ‰å¼ºå¤§çš„ç»ˆç»“èƒ½åŠ›ï¼Œä½†ä¸å†ç ´åå¹³è¡¡ã€‚
- **UI æç¤º**ï¼š
  - HTML æ¸²æŸ“å±‚æ–°å¢žäº†è™šçº¿è¾¹æ¡†å’Œã€Œæ¶ˆè€—ã€æ–‡å­—æ ‡ç­¾ï¼Œæžå¤§åœ°æå‡äº†çŽ©å®¶çš„æˆ˜æœ¯æ„ŸçŸ¥åŠ›ã€‚
  - `desc` å­—æ®µçš„åŒæ­¥æ ‡æ³¨æ˜¯è‰¯å¥½çš„å¼€å‘ä¹ æƒ¯ã€‚

### ðŸš€ Recommendation for Phase 4
é¡¹ç›®çŽ°å·²å…·å¤‡åšå®žçš„åº•å±‚é€»è¾‘ï¼Œå»ºè®®ä¸‹ä¸€é˜¶æ®µé‡ç‚¹å¼€å‘ï¼š
1. **é—ç‰©ç³»ç»Ÿæ·±åº¦åŒ–**ï¼šç›®å‰çš„é—ç‰©é€»è¾‘ç›¸å¯¹é›¶æ•£ï¼Œå»ºè®®å»ºç«‹ä¸“é—¨çš„ `RelicManager` å¤„ç†æˆ˜æ–—å¤–/æˆ˜æ–—å†…çš„å„ç§è¢«åŠ¨è§¦å‘ã€‚
2. **åœºæ™¯è¿‡æ¸¡ç¾ŽåŒ–**ï¼šå¢žåŠ ç®€å•çš„è¿‡åœºåŠ¨ç”»æˆ–ç²’å­æ•ˆæžœï¼Œæå‡â€œä¿®ä»™â€çš„æ²‰æµ¸æ„Ÿã€‚

---

*Last updated: 2026-02-20 by Lead Reviewer ðŸ•µï¸*


---

## ðŸ» Phase 4 - é—ç‰©/äº‹ä»¶/å•†åº—æ‰©å±• + å¹³è¡¡æ€§è°ƒæ•´ (2026-02-20)

### å·²å®Œæˆ

#### ä»»åŠ¡ 1ï¼šé—ç‰©æ± æ‰©å……ï¼ˆ+15 ä¸ªé—ç‰©ï¼‰

**Commonï¼ˆ7ä¸ªï¼‰**ï¼š
- ðŸªž æŠ¤å¿ƒé•œï¼šæˆ˜æ–—å¼€å§‹+3æŠ¤ç›¾
- ðŸ‘› çµçŸ³è¢‹ï¼šæˆ˜æ–—å¼€å§‹+1çµæ°”
- ðŸª¶ è½»èº«ç¬¦ï¼šæ¯å›žåˆæŠ½ç‰Œ+1
- ðŸ’ª ç‚¼ä½“ä¸¹ï¼šèŽ·å¾—æ—¶ç”Ÿå‘½ä¸Šé™+10ï¼ˆonAcquire ç±»åž‹ï¼‰
- ðŸ›¡ï¸ æŠ¤ç”²ç¬¦ï¼šæ¯å›žåˆ+1æŠ¤ç›¾
- ðŸ”® å›žçµç ï¼šæ¯3å›žåˆ+2çµæ°”ï¼ˆturnStartConditionalï¼‰
- ðŸ‘¢ ç–¾é£Žé´ï¼šéžé¦–å›žåˆæ¯å›žåˆå¤šæŠ½1ç‰Œï¼ˆturnStartConditionalï¼‰

**Uncommonï¼ˆ5ä¸ªï¼‰**ï¼š
- âš”ï¸ å‰‘åŒ£ï¼šæ‰“å‡º3å¼ å‰‘ä¿®ç‰ŒåŽï¼Œä¸‹ä¸€å¼ å‰‘ä¿®ç‰Œ-1è´¹ï¼ˆswordCounterï¼‰
- ðŸ–Šï¸ ç¬¦ç¬”ï¼šç¬¦ä¿®ç‰Œä¼¤å®³+2ï¼ˆonTalismanCard â†’ getExtraDamageï¼‰
- â˜ ï¸ æ¯’å›Šï¼šæˆ˜æ–—å¼€å§‹å…¨ä½“æ•Œäºº+2æ¯’ï¼ˆbattleStartPoisonï¼‰
- ðŸ—¿ é‡‘åˆšä½“ï¼šå—ä¼¤åŽä¸‹å›žåˆ+2åŠ›é‡ï¼ˆonDamageTakenï¼‰
- â˜¯ï¸ åŒä¿®æ³•å®ï¼šæ­£é‚ªç‰Œå‡äº«å—æ´¾ç³»å‡è´¹ï¼ˆdualFactionï¼‰

**Rareï¼ˆ3ä¸ªï¼‰**ï¼š
- âš¡ ä»™å‰‘èƒšèƒŽï¼šå‰‘ä¿®ç‰Œä¼¤å®³+3ï¼ˆswordUpgrade â†’ getExtraDamageï¼‰
- ðŸ“• è¡€ç¥­é­”å…¸ï¼šæ¯ç´¯è®¡æŸå¤±5HPèŽ·å¾—1åŠ›é‡ï¼ˆbloodSacrifice â†’ takeDamage è¿½è¸ªï¼‰
- ðŸª¬ è½®å›žé•œï¼šæ­»äº¡æ—¶æ¢å¤50%HPï¼Œæ¶ˆè€—åž‹ï¼ˆdeathSave â†’ takeDamage ä¸­è§¦å‘ï¼‰

#### ä»»åŠ¡ 2ï¼šå•†åº—ç‰©ä»·å¹³è¡¡
- å¡ç‰Œï¼šCommon 50, Uncommon 75, Rare 125 âœ…
- é—ç‰©ä»·æ ¼æŒ‰ç¨€æœ‰åº¦ï¼šCommon 100-140, Uncommon 200-300, Rare 400-500 âœ…
- åˆå§‹é‡‘å¸ 50ï¼Œæœ‰å†³ç­–ç©ºé—´ âœ…
- ShopScene æ”¯æŒ tempDiscountï¼ˆç¥žç§˜å•†äººäº‹ä»¶ä¸´æ—¶æŠ˜æ‰£ï¼‰

#### ä»»åŠ¡ 3ï¼šäº‹ä»¶æ± æ‰©å……ï¼ˆ+8 ä¸ªäº‹ä»¶ï¼‰

**æ­£é¢ï¼ˆ4ä¸ªï¼‰**ï¼šðŸŽ å¥‡é‡å®ç®± / ðŸ§™ ç¥žç§˜å•†äºº / ðŸ”ï¸ å¤æ´žåºœ / ðŸ’¡ çªç ´æ„Ÿæ‚Ÿ
**é£Žé™©ï¼ˆ4ä¸ªï¼‰**ï¼šðŸ‘¹ é­”é“è€ƒéªŒ / â›ˆï¸ å¤©åŠ«è¯•ç‚¼ / ðŸ¤ é‚ªä¿®äº¤æ˜“ / ðŸŒ€ èµ°ç«å…¥é­”

#### ä»»åŠ¡ 4ï¼šå¢ƒç•Œç³»ç»Ÿå¾®è°ƒ
- ç‚¼æ°”â†’ç­‘åŸºï¼š+10HP, +1çµæ°”
- ç­‘åŸºâ†’é‡‘ä¸¹ï¼š+15HP, +1çµæ°”, éšæœºUncommoné—ç‰©
- é‡‘ä¸¹â†’å…ƒå©´ï¼ˆæ–°å¢žï¼‰ï¼š+20HP, +1çµæ°”, éšæœºRareé—ç‰©

### ç»™å°è¢‹ç†Šçš„ Review é—®é¢˜

1. **é‡‘åˆšä½“è§¦å‘**ï¼šå—ä¼¤å¤šæ¬¡ä»…è§¦å‘ä¸€æ¬¡+2åŠ›é‡ï¼Œè¿˜æ˜¯åº”æŒ‰æ¬¡æ•°å åŠ ï¼Ÿ
2. **è½®å›žé•œÃ—è¡€ç¥­é­”å…¸äº¤äº’**ï¼šæ¢å¤HPä¸è§¦å‘è¡€ç¥­ï¼ŒOKï¼Ÿ
3. **äº‹ä»¶æ”¶ç›Šæ¯”**ï¼šé­”é“è€ƒéªŒï¼ˆ-10HPæ¢Rareé—ç‰©ï¼‰vs èµ°ç«å…¥é­”ï¼ˆç§»é™¤ç‰Œï¼‰ï¼Œæ˜¯å¦å¤±è¡¡ï¼Ÿ
4. **åŒä¿®æ³•å®**ï¼šæ­£é‚ªéƒ½-1è´¹æ˜¯å¦å¤ªå¼ºï¼Ÿéœ€é™åˆ¶ï¼Ÿ
5. **ç¥žç§˜å•†äºº**ï¼šäº‹ä»¶è·³å•†åº—æ˜¯å¦å¯¼è‡´ä¸€å±‚ä¸¤æ¬¡è´­ç‰©ï¼Ÿ

*Updated: 2026-02-20 by ä»£ç ç†Š ðŸ»*

## ðŸ•µï¸ Code Review - Phase 4 (Relics, Events, & Balance)

**Reviewer:** Little Wombat ðŸ¨
**Status:** âœ… **Approved**

### âœ… Highlights
1.  **Relic System**:
    *   Added 25 new relics with diverse effects!
    *   Mechanics like `onFireCard`, `swordCounter`, and `dualFaction` add great synergy depth.
    *   `reincarnation_mirror` (Death Save) is a nice safety net for Roguelikes.
2.  **Event Variety**:
    *   Added 10+ new events including faction-specific choices (`dao_choice`) and trade-offs.
    *   `qi_deviation` (remove card vs lose HP) is a classic deck-thinning mechanic.
3.  **Balance**:
    *   Confirmed Phase 3 fixes: `exhaust` logic is now present in `CardSystem.js`.
    *   Consumables like `spirit_pill` now correctly exhaust to prevent infinite loops.

### âš ï¸ Minor Issues (Polishing)
1.  **Relic UI**:
    *   Ensure new relic icons (e.g., ðŸª¬, ðŸ²) render correctly on all OS/Browsers. Some might need image assets instead of emojis if consistency is key.
2.  **Event Logic**:
    *   `removeRelic` in `evil_trade`: Make sure the player *has* a relic before offering this option, or handle the "no relic" case gracefully (e.g., disable the button).

### ðŸš€ Recommendation
Phase 4 looks solid. The game loop (Battle -> Reward -> Event -> Shop) is now feature-complete.
You can proceed to **Phase 5 (Polish & Sound)** or start integration testing!

**Next Step**: Prepare for Phase 5.
